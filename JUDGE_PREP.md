# 審査準備チェックリスト (JUDGE_PREP)

> **用途**: 第4回 Agentic AI Hackathon with Google Cloud 審査対策
> **対象**: デモ発表者（本人用）
> **最終更新**: 2026-02-12

---

## 30秒エレベーターピッチ

> 経理の現場では、月末や決算期に見積書の固定資産判定を大量にこなします。
> しかし時間に追われ、判断を十分に検証する余裕がありません。
>
> ここにAIの全自動化を入れると、誤った判断を高速に通過させるリスクがあります。
>
> 私たちのシステムは違います。**判断が割れたら、AIが自ら止まります。**
> 何の情報が不足しているかを具体的に提示し、人間に確認を求めます。
> 回答を受けて再判定し、変更の全過程をDIFFとして記録します。
>
> **止まる、聞く、変わる。** これが私たちの定義するAgentic AIです。

---

## デモ前チェックリスト

### 環境

- [ ] Cloud Run API が起動している（ヘルスチェック: `/health` → `{"ok": true}`）
- [ ] Cloud Run UI が起動している（ブラウザでアクセス可能）
- [ ] ローカルDocker環境をバックアップとして準備（Cloud Run障害時のフォールバック）
- [ ] `.env` にAPIキーが設定されている（`GOOGLE_API_KEY` or `GOOGLE_CLOUD_PROJECT`）
- [ ] `GEMINI_ENABLED=1` が設定されている

### データ

- [ ] デモ用JSONファイルがドロップダウンに表示される
  - `demo01_capital_server.json`（CAPITAL_LIKE: サーバー新設工事）
  - `demo04_guidance_ambiguous.json`（GUIDANCE: 撤去・移設混在工事）
- [ ] ゴールデンセット評価が通る（`python scripts/eval_golden.py` → 10/10）

### 画面・表示

- [ ] ブラウザ: Chrome、フルスクリーン、1920x1080 推奨
- [ ] サイドバーにCloud Run URLが表示されている
- [ ] Legal Citations: OFF（デフォルト）
- [ ] フォントサイズが審査員の画面から読める大きさ

### ネットワーク

- [ ] インターネット接続が安定している
- [ ] Gemini API へのアクセスが可能（タイムアウトなし）
- [ ] フォールバック: ローカルDocker版が即座に切替可能

---

## デモシナリオ（3ケース）

### Case 1: CAPITAL_LIKE（即判定）

**データ**: `demo01_capital_server.json`
**シナリオ**: サーバー新設工事の見積書

```
投入 → 即座に CAPITAL_LIKE（緑バッジ）
     → 確信度 ~0.8
     → エビデンス: キーワード（サーバー、新設）、金額
     → トレース: extract -> parse -> rules -> format
```

**デモポイント**: 明確なケースは即座に、根拠付きで判定する

---

### Case 2: GUIDANCE（止まる → 聞く → 変わる）

**データ**: `demo04_guidance_ambiguous.json`
**シナリオ**: 撤去・移設を含む曖昧な工事見積書

```
投入 → GUIDANCE（黄バッジ） ... 止まる
     → 「Agent Needs Information」パネル表示 ... 聞く
     → クイックピックで「機能向上を伴う工事」を選択
     → 「Re-run Classification」をクリック
     → CAPITAL_LIKE に変更、確信度 0.7 → 0.85 ... 変わる
     → DIFFカード表示（Before/After）
```

**デモポイント**: AIが自律的に停止し、不足情報を構造化して質問する。再判定後のDIFFが監査証跡

---

### Case 3: EXPENSE_LIKE（補足用・時間があれば）

**データ**: 経費寄りのデモデータ
**シナリオ**: 少額の修繕・消耗品

```
投入 → EXPENSE_LIKE（青バッジ）
     → 確信度が高い
     → 少額資産の特例に基づく判定理由
```

**デモポイント**: 3値判定の完全性を示す

---

## FAQ（想定質問と回答）

### Q1: なぜルールベースではなくAIを使うのか？

**A**: ルールベースでは対応できない「曖昧なケース」が実務の核心です。撤去と移設が混在する工事、原状回復か機能向上かの判断など、文脈依存の判定にはAIの推論能力が必要です。さらに本システムはAIの弱点（過信・断定）をStop-first設計で制御しています。

### Q2: 誤分類のリスクはどう管理するか？

**A**: 3つの仕組みで管理しています。(1) 確信度 < 0.7 で自動的にGUIDANCEへ強制フォールバック。(2) ポリシーファイルで企業固有のStop条件を追加可能。(3) Before/After DIFFで判定変更の全過程を監査証跡として保存。誤分類を「防ぐ」のではなく、「迷う場面で止まる」設計です。

### Q3: 既存の会計システムとの統合は？

**A**: REST API（`POST /classify`）でJSON入出力するため、既存システムからのAPI呼び出しで統合可能です。見積書データをOpal JSON形式で送信すれば判定結果が返ります。ERP連携、RPA連携、バッチ処理のいずれにも対応できる設計です。

### Q4: スケーラビリティは？

**A**: Cloud Runのサーバーレスアーキテクチャにより、リクエスト数に応じて自動スケーリングします。ステートレス設計のため水平拡張が可能で、同時処理数の上限はCloud Runの設定で調整できます。

### Q5: セキュリティは？

**A**: 多層防御を採用しています。(1) Cloud RunのTLS暗号化とCloud IAMによるアクセス制御。(2) Docker非rootユーザー実行（appuser）でコンテナ内の権限を最小化。(3) HEALTHCHECKによるコンテナ死活監視。(4) `.env`からのAPIキー値削除済み（環境変数で注入）。処理対象は見積書の品目名・金額・数量のみで、個人情報は処理しません。デモデータは全て架空データです。

### Q6: GUIDANCEが多すぎると業務効率が落ちないか？

**A**: ポリシーファイル（`policies/company_default.json`）でGUIDANCE発生条件を企業ごとに調整できます。運用実績に基づいてキーワードや閾値を最適化することで、適切なバランスに収束します。デフォルトは安全寄り（GUIDANCEが多め）に設定しています。

### Q7: Google Cloud AIのどのサービスをどう使っているか？

**A**: 4つのサービスを活用しています。
- **Gemini 3 Pro Preview**: `thinking_level=HIGH`で税務知識を注入した深い推論を実行
- **Cloud Run**: API/UIのサーバーレスデプロイ
- **Document AI**: PDF見積書からの高精度テキスト抽出（Feature Flag: `USE_DOCAI=1`）
- **Vertex AI Search**: 法令・通達の根拠を自動引用（Feature Flag: `VERTEX_SEARCH_ENABLED=1`）

### Q8: ゴールデンセット100%は少なすぎないか？

**A**: ゴールデンセットは現在10ケースですが、各ケースは実務で頻出する判断パターン（明確な資産、明確な経費、曖昧なケース）を網羅しています。加えて、pytest自動テストが136件（adapter/classifier/E2E等）通過しており、コードレベルの品質も担保しています。Stop-first設計により、判断が割れるケースはGUIDANCEとして人間に委ねるため、「誤判定」ではなく「要確認」として処理されます。ケース数の拡充は継続的に行う計画です。

### Q9: このアプローチは固定資産判定以外にも応用できるか？

**A**: はい。Stop-first設計パターンは汎用的です。判断が割れる場面で自動化を停止し、人間に確認を求めるアプローチは、医療診断の支援、法務レビュー、与信判定、品質検査など、誤判定のコストが高い領域全般に適用可能です。

### Q10: なぜ「止まる」ことが価値なのか？

**A**: AIの最大のリスクは「自信を持って間違える」ことです。特に月末・決算期の経理現場では、AIの判定結果を検証する余裕がありません。全自動化は、誤った判断を高速に通過させるリスクを生みます。「止まる」ことで、人間が確認すべきポイントを明示し、判断の質を担保します。これは「AIの限界」ではなく「AIの知性」です。

### Q11: Before/After DIFFは実務でどう使われるか？

**A**: 3つの場面で活用されます。(1) 経理担当者がGUIDANCE案件の最終判断を行う際の判断材料。(2) 上長レビュー時の承認根拠。(3) 監査法人による事後検証での監査証跡。判定がどのように変わったか、なぜ変わったかが完全に記録されています。

---

## 審査基準に対する自己評価

| 審査基準 | 評価 | 根拠 |
|----------|------|------|
| **技術力** | A | Gemini 3 Pro（thinking_level=HIGH）、Document AI、Vertex AI Search、Cloud Run の4サービスを実装レベルで統合。凍結スキーマv1.0による堅牢な設計 |
| **独創性** | A+ | 「AIが止まること」を価値とする逆転の発想。Agentic AIの定義を「全自動化」から「判断制御」に再定義 |
| **実用性** | A | 経理現場の「月末に検証する余裕がない」という現実課題に直結。ポリシーカスタマイズで企業別対応可能 |
| **完成度** | A | デモUI（Streamlit）、API（FastAPI/Cloud Run）、テスト（pytest 136件通過 + Golden Set 10/10）、ドキュメント一式が揃っている |
| **Google Cloud活用度** | A | Gemini 3 Pro Preview + Document AI + Vertex AI Search + Cloud Run。Feature Flagによる段階的活用設計 |

### 強みのまとめ

1. **「止まる→聞く→変わる」のAgentic Loop** が他作品にない独自の設計思想
2. **Before/After DIFF** による監査証跡が実務に直結する価値を持つ
3. **Google Cloud AIの4サービス統合** が技術的な深さを示す
4. **Golden Set 100%** + Stop-first設計で精度と安全性を両立

### 想定される弱点と対策

| 弱点 | 対策 |
|------|------|
| ゴールデンセットが10件と少ない | Stop-first設計により曖昧ケースはGUIDANCEで安全に処理。ケース拡充は継続計画 |
| PDF抽出の精度依存 | Document AI + PyMuPDF/pdfplumberのフォールバック設計 |
| 日本の税法に特化 | 設計パターン自体は汎用的。ポリシーファイルで他国の税法にも対応可能 |

---

## デモ中のトラブル対策

| トラブル | 対処法 |
|---------|--------|
| Cloud Run がタイムアウト | ローカルDocker版に即座に切替（[DEMO_FALLBACK_DOCKER.md](docs/DEMO_FALLBACK_DOCKER.md)） |
| Gemini API エラー | 事前にキャッシュしたレスポンスで説明を継続 |
| UI が表示されない | `streamlit run ui/app_minimal.py` で再起動 |
| GUIDANCE が出ない | `demo04_guidance_ambiguous.json` を再選択して再実行 |
| DIFF が表示されない | 再判定ボタンを押し忘れていないか確認 |
