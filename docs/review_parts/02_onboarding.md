# オンボーディング/初回体験レビュー

## サマリ

app_minimal.py（コンポーネントベース版）は初回体験として良好。ヒーローセクションの価値提案・ステップインジケーター・PDFドラッグ&ドロップの導線が直感的で、30秒以内にコア体験に到達可能。一方、app.py（JSON入力版）はOpal/JSON/Agent等の技術用語が全面に出ており、ペルソナ（ITリテラシーの低い経理担当者）にとって致命的な認知障壁がある。また両画面共通で、初回ユーザー向けの段階的ガイダンス（空の状態の説明、初回チュートリアル）が不足しており、「何から始めればよいか」の迷いが生じる余地がある。

## ユーザージャーニー分析

ペルソナ: 初めて使う経理担当者（ITリテラシー低、税務用語は理解するがIT用語は理解しない）

### app_minimal.py（コンポーネント版）のジャーニー

| ステップ | ユーザー行動 | 所要時間 | 評価 |
|---------|------------|---------|------|
| 1. 画面表示 | ヒーロー「固定資産判定 AI — 見積書をアップするだけ。」を見る | 0-3秒 | OK: 価値提案が1文で伝わる |
| 2. ステップ理解 | 「📤 アップロード → 🤖 AI判定 → ✅ 結果確認」を確認 | 3-5秒 | OK: 3ステップで全体像が把握できる |
| 3. PDF準備 | ファイルアップローダーを認識し、PDFを選択/ドロップ | 5-15秒 | OK: ドラッグ&ドロップのUIが直感的 |
| 4. 判定実行 | 「🔍 判定を実行」ボタンをクリック | 15-20秒 | OK: CTAが1つで明確 |
| 5. 待機 | スケルトンローディングを見て待つ | 20-30秒 | OK: 進捗フィードバックあり |
| 6. 結果確認 | 判定カードで結果を確認 | 30-40秒 | OK: 色分けとアイコンで直感的 |
| 7. GUIDANCE対応 | 要確認の場合、2択→詳細質問に回答 | 40-90秒 | OK: ステップ進捗表示あり |

**総合評価**: TTFV（Time to First Value）は約30秒でチェックリスト目標（60秒以内）を達成。基本導線は良好。

### app.py（JSON入力版）のジャーニー

| ステップ | ユーザー行動 | 所要時間 | 評価 |
|---------|------------|---------|------|
| 1. 画面表示 | 「見積書 固定資産判定（Opal抽出 × Agentic判定）」を見る | 0-3秒 | NG: 「Opal」「Agentic」が意味不明 |
| 2. タブ選択 | 「📋 Opal JSON入力」「📤 PDFアップロード」を見る | 3-10秒 | NG: 「JSON」がわからず迷う |
| 3. 情報過多 | VALUE_STATEMENT、進め方、Step1説明を読む | 10-30秒 | NG: 情報量が多すぎる |
| 4. サンプル or 貼付 | サンプル選択 or JSON貼付を判断 | 30-60秒 | NG: JSONを貼り付ける概念がない |
| 5. 判定実行 | 「判定を実行して進む」をクリック | 60秒以降 | 遅い: Aha Momentまで60秒超 |

**総合評価**: ペルソナに対して不適格。TTFVが60秒を超える可能性が高い。

## 指摘事項

### 指摘1

- **深刻度**: Critical
- **対象ファイル・行番号**: `ui/app.py:21-23`
- **問題の説明**: タイトル「見積書 固定資産判定（Opal抽出 × Agentic判定）」およびサブタイトル「Opal項目抽出 / Agent判定処理（Stop設計）」に技術用語（Opal、Agentic、Agent、Stop設計）が使われており、ペルソナ（ITリテラシーの低い経理担当者）には全く伝わらない。最初の5秒で「何のツールかわからない」と離脱するリスクが極めて高い。
- **チェックリストの該当項目**: First_30_Seconds Phase 1「ランディング画面でプロダクトの価値が1文で伝わるか」「その1文に専門用語が含まれていないか」/ Onboarding 2「専門用語・独自用語を排除したか」
- **修正提案**: app_minimal.pyのヒーローセクションと同等の表現に統一する。「見積書をアップするだけ。資産か経費か、AIが判定します。」のような平易な表現を使う。

### 指摘2

- **深刻度**: Critical
- **対象ファイル・行番号**: `ui/app.py:32-37`, `ui/app.py:649`
- **問題の説明**: タブ構成で「📋 Opal JSON入力」が最初に表示される。ペルソナはJSONが何かを知らず、「自分が使うべきタブはどちらか」で迷う。さらにStep1の説明文にも「Opal」「JSON」「OCR」等の技術用語が頻出する。
- **チェックリストの該当項目**: Onboarding 2「専門用語・独自用語を排除したか」/ Onboarding 4「初回画面では必須機能だけを表示しているか」「高度な設定・機能は初回表示から隠しているか」
- **修正提案**: PDFアップロードをデフォルトタブにするか、JSON入力を開発者向け機能として隠す（app_minimal.pyの`?dev=1`方式を参考に）。ペルソナの動線ではPDF→判定→結果のみを見せる。

### 指摘3

- **深刻度**: Major
- **対象ファイル・行番号**: `ui/app.py:617-626`
- **問題の説明**: ページ冒頭のinfo枠「なぜ『止まるAgent』が必要なのか」は、ツールの思想説明であり初回ユーザーが読むべき内容ではない。認知負荷を上げ、ユーザーの最初のアクション（PDF投入）を遅延させる。
- **チェックリストの該当項目**: Onboarding 2「各ステップで『ユーザーが考える必要がある?マーク』を列挙し、潰したか」/ First_30_Seconds アンチパターン「読まないと進めないテキストの壁」
- **修正提案**: 初回表示では削除するか、判定結果画面の補足説明として移動する。または「詳しく知る」expanderに格納する。

### 指摘4

- **深刻度**: Major
- **対象ファイル・行番号**: `ui/components/hero_section.py:24`, `ui/components/hero_section.py:65`
- **問題の説明**: 「Powered by Gemini 3 Pro」バッジが表示されるが、ペルソナにとって「Gemini 3 Pro」は意味不明な技術用語。ツールの信頼性向上に寄与せず、むしろ「自分向けのツールではない」という印象を与える可能性がある。
- **チェックリストの該当項目**: Onboarding 2「専門用語・独自用語を排除したか」/ First_30_Seconds Phase 1「ロゴ・ブランドが視界に入るが、主張しすぎていないか」
- **修正提案**: バッジを削除するか、開発者モード時のみ表示する。または「AI搭載」程度の平易な表現に変更する。

### 指摘5

- **深刻度**: Major
- **対象ファイル・行番号**: `ui/components/input_area.py:350-355`
- **問題の説明**: 「🎯 高精度モード（AI Vision）」のトグルが初回画面に表示される。ペルソナは「高精度モード」と「通常モード」の違いが判断できず、「どちらを選べばいいかわからない」という認知負荷が発生する。「AI Vision」も技術用語。
- **チェックリストの該当項目**: Onboarding 4「初回画面では必須機能だけを表示しているか」「高度な設定・機能は初回表示から隠しているか」/ Onboarding 2「画面上の選択肢を5つ以下に絞ったか」
- **修正提案**: デフォルトで高精度モードをONにし、通常モードへの切り替えを詳細設定に隠す。または初回はトグルを非表示にし、精度に問題があった場合にのみ表示する。

### 指摘6

- **深刻度**: Major
- **対象ファイル・行番号**: `ui/components/input_area.py:413-414`, `ui/app_minimal.py:695`
- **問題の説明**: PDFをアップロードしていない初期状態（Empty State）のガイダンスが「👆 PDFをアップロードして判定を実行」の1行のみ。初回ユーザーにとっては「どんなPDFを用意すればいいのか」「サンプルで試せることがわからない」状態になる。
- **チェックリストの該当項目**: Onboarding 7「Empty State（空の状態）に有用なガイダンスがあるか」/ First_30_Seconds Phase 2「入力を始める前に『何が得られるか』が分かっているか」
- **修正提案**: Empty Stateに以下を追加: (1) 対応PDF形式の説明（見積書、請求書等）、(2) サンプルで試す導線の強調、(3) 「結果はこのような形で表示されます」のプレビュー画像。

### 指摘7

- **深刻度**: Major
- **対象ファイル・行番号**: `ui/app.py:289`
- **問題の説明**: app.pyのエラーメッセージ `f"JSONのパースに失敗しました: {e}"` は技術者向けの表現で、ペルソナには「パース」「JSON」が理解できない。Pythonのエラーメッセージがそのまま表示される可能性もある。
- **チェックリストの該当項目**: Onboarding 7「エラーメッセージが『何をすればよいか』を示しているか」
- **修正提案**: 「入力データの形式が正しくありません。サンプルを選択するか、正しい形式のデータを貼り付けてください。」のような平易なメッセージに変更する。

### 指摘8

- **深刻度**: Minor
- **対象ファイル・行番号**: `ui/app_minimal.py:279-284`
- **問題の説明**: サイドバーのヘルプ「使い方」が「1. PDFをドラッグ＆ドロップ / 2. 判定ボタンをクリック / 3. 結果を確認、CSVでダウンロード」の3行のみ。初回ユーザーにとっては不十分で、「どんなPDFが対象か」「結果の見方は」「困ったときは」等の情報が欠けている。
- **チェックリストの該当項目**: Onboarding 2「関連する要素がグループ化されているか」/ Onboarding 7「Empty State（空の状態）に有用なガイダンスがあるか」
- **修正提案**: ヘルプの充実。具体的には「対象書類: 見積書・請求書のPDF」「対応サイズ: 5ページまで」「判定結果の見方: 3つのカテゴリ」等を追記する。

### 指摘9

- **深刻度**: Minor
- **対象ファイル・行番号**: `ui/app_minimal.py:612-618`
- **問題の説明**: 免責事項テキストが画面最下部にのみ配置されており、初回ユーザーが判定結果を「正式な判定」と誤解するリスクがある。フォントサイズも0.7remと非常に小さい。
- **チェックリストの該当項目**: Onboarding 2「視覚的階層（サイズ、色、配置）で優先順位が伝わるか」
- **修正提案**: 判定結果カードの直下にも簡潔な免責注記（「参考情報です。最終判断は税理士にご確認ください」）を配置する。

### 指摘10

- **深刻度**: Minor
- **対象ファイル・行番号**: `ui/app_minimal.py:207-212`, `ui/styles.py:130-133`
- **問題の説明**: ページ設定で `initial_sidebar_state="collapsed"` となっているが、サイドバーにヘルプが格納されている。初回ユーザーはサイドバーの存在に気づかず、ヘルプ・履歴機能・セキュリティ情報にアクセスできない可能性がある。
- **チェックリストの該当項目**: Onboarding 4「機能の登場タイミングが『必要になった瞬間』に合わせてあるか」
- **修正提案**: 初回アクセス時のみサイドバーを展開する、またはメイン画面内にヘルプへのリンク/ボタンを配置する。

### 指摘11

- **深刻度**: Minor
- **対象ファイル・行番号**: `ui/app.py:230-242`
- **問題の説明**: app.pyのステップナビゲーション（ラジオボタン）は自由にステップ間を移動できるが、Step2（正規化）やStep3（判定）にデータなしでアクセすると「Step1でサンプル選択または貼付を行い、判定ボタンを押してください」というwarningが表示される。ユーザーが迷って間違ったステップに遷移する余地がある。
- **チェックリストの該当項目**: Onboarding 7「やり直しが簡単にできるか（Undo、Back）」/ Onboarding 3「Ability（どうやるか）を最大化したか」
- **修正提案**: データが存在しないステップは無効化する（disabled状態にする）。

### 指摘12

- **深刻度**: Minor
- **対象ファイル・行番号**: `ui/components/guidance_panel.py` 全体
- **問題の説明**: GUIDANCEパネルの2段階フロー（質問1→質問2→判定）は非常に良い設計だが、「選び直す」ボタンが目立たず、一度選択した後に戻りにくい。またStep 2の質問（修繕頻度、入替有無）の選択肢説明が一部抽象的。
- **チェックリストの該当項目**: Onboarding 7「やり直しが簡単にできるか（Undo、Back）」/ Onboarding 5「プログレスバーやステップインジケーターを表示しているか」
- **修正提案**: 「選び直す」ボタンのサイズ・色を目立たせる。質問の選択肢に具体例を追加する（例: 「定期的（3年以内）」→「例: エアコンのフィルター交換、定期点検」）。

## チェックリスト照合結果

### Onboarding_Design_Checklist 照合

| セクション | 項目 | app_minimal.py | app.py |
|-----------|------|:-:|:-:|
| **1. 価値提供** | Aha Momentを1つに絞った | 準拠 | 非準拠（情報過多） |
| | Aha Momentまで3ステップ以内 | 準拠（PDF→判定→結果） | 非準拠（タブ選択→入力方法選択→入力→判定→ステップ遷移） |
| | 説明テキストなしで伝わる | 準拠 | 非準拠（大量の説明文） |
| | TTFVが60秒以内 | 準拠（約30秒） | 非準拠（60秒超の可能性） |
| **2. 認知負荷** | 選択肢を5つ以下 | 準拠 | 非準拠（タブ×2、サンプル選択、JSON貼付、ポリシー選択…） |
| | 専門用語排除 | 一部非準拠（AI Vision、Gemini） | 非準拠（Opal、JSON、Agentic、Agent、Stop設計） |
| | ボタンがクリック可能と分かる | 準拠 | 準拠 |
| | 視覚的階層で優先順位 | 準拠 | 一部非準拠（情報の優先度が不明確） |
| **3. 行動設計** | 最初のアクションが30秒以内 | 準拠 | 非準拠 |
| | Motivationが画面に表示 | 準拠（ヒーロー文） | 一部準拠（VALUE_STATEMENTはあるが埋もれる） |
| | Ability最大化 | 準拠（ドラッグ&ドロップ） | 非準拠（JSON貼付は高いスキル要求） |
| **4. 段階的開示** | 初回は必須機能のみ | 一部非準拠（高精度トグル） | 非準拠（全機能が露出） |
| | 高度機能は隠す | 準拠（?dev=1） | 非準拠（ポリシー設定がサイドバーに常時表示） |
| | 一度に表示するフィールド最小化 | 準拠 | 非準拠（サンプル選択＋テキスト貼付が同時表示） |
| **5. フィードバック** | アクション完了後の即座のフィードバック | 準拠（スケルトンローディング→結果カード） | 準拠（プログレスバー→結果表示） |
| | プログレスインジケーター | 準拠（ステップインジケーター） | 準拠（st.progress） |
| | 最初の成功体験の祝福 | 非準拠（特に演出なし） | 非準拠（特に演出なし） |
| **6. 投資** | 小さな投資を初回で求める | 準拠（PDF1つ） | 非準拠（JSON理解が必要） |
| **7. エラーハンドリング** | エラーメッセージが対処法を示す | 準拠 | 一部非準拠（技術的エラーメッセージ） |
| | Empty Stateにガイダンス | 非準拠（1行のみ） | 一部準拠（説明はあるが技術的） |
| | やり直し（Undo/Back） | 準拠 | 準拠（戻るボタンあり） |

### First_30_Seconds_Design_Checklist 照合

| フェーズ | 項目 | app_minimal.py | app.py |
|---------|------|:-:|:-:|
| **Phase 1（5秒）** | 価値が1文で伝わる | 準拠 | 非準拠 |
| | 専門用語なし | 一部非準拠 | 非準拠 |
| | ビジュアルが価値を補強 | 準拠（ステップインジケーター） | 一部準拠 |
| | CTAボタンが1つだけ | 準拠 | 非準拠（複数入力手段） |
| | 行動を促すラベル | 準拠（「🔍 判定を実行」） | 準拠（「判定を実行して進む」） |
| **Phase 2（15秒）** | 最初のインタラクションが1つ | 準拠（PDFドロップ） | 非準拠（タブ選択が先） |
| | インタラクションが自明 | 準拠 | 非準拠 |
| | アカウント作成不要 | 準拠 | 準拠 |
| | フォームフィールド3つ以下 | 準拠（PDF1つ） | 非準拠（サンプル選択＋JSON貼付＋ポリシー） |
| **Phase 3（30秒）** | コア機能を1回使わせる | 準拠 | 非準拠（30秒以内は困難） |
| | ワンアクションで完了 | 準拠 | 非準拠 |
| | ポジティブフィードバック | 一部準拠（色分けカード） | 一部準拠 |
| | 次のステップ提示 | 準拠（「次にやること」表示） | 準拠 |
| **アンチパターン** | 5枚以上のウォークスルー | 該当なし（OK） | 該当なし（OK） |
| | スキップ不可のチュートリアル | 該当なし（OK） | 該当なし（OK） |
| | 全機能紹介ツアー | 該当なし（OK） | 一部該当（進め方3ステップが冗長） |
| | 読まないと進めないテキストの壁 | 該当なし（OK） | 該当（info枠の長文） |
| **設計原則** | Show, Don't Tell | 一部準拠 | 非準拠（説明過多） |
| | Value Before Signup | 準拠 | 準拠 |
| | One Thing At A Time | 準拠 | 非準拠 |
| | Default to Done | 非準拠（デフォルト値なし） | 一部準拠（サンプル初期選択あり） |

## 総合評価

### 良い点（Keep）

1. **app_minimal.py + コンポーネント群は初回体験として優秀**。ヒーローの価値提案→PDFドロップ→判定ボタンの3ステップ導線が明確。
2. **guidance_panel.pyの2段階フローは秀逸**。「修繕 or 新規購入」→「頻度 or 入替」のステップ分割、プログレス表示、ヒント付与、「わからない場合は税理士に」のフォールバックが設計工学的に正しい。
3. **result_card.pyの信頼度表現**（「ほぼ確実」「たぶん大丈夫」「念のため確認を」）はペルソナに適した平易な日本語。
4. **エラーメッセージ**（input_area.py）は非技術者向けに適切にローカライズされている。
5. **開発者機能の分離**（?dev=1パラメータ）は段階的開示の好例。

### 改善すべき点（Improve）

1. **app.pyの全面的な用語見直し**が必要。Opal、JSON、Agentic、Agent、Stop設計等の技術用語をペルソナ向けに翻訳する。
2. **高精度モードのトグルを初回画面から隠す**。ペルソナには判断できない選択肢。
3. **Empty Stateの充実**。「何をすればよいか」「どんなPDFが対象か」を具体的に示す。
4. **初回成功体験の演出追加**。判定完了時のポジティブフィードバック（アニメーション、メッセージ）が不足。
5. **Gemini 3 Proバッジの削除または簡素化**。ペルソナには不要な情報。
