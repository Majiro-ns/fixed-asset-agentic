<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=1920, height=1080">
<title>System Architecture - Fixed Asset Agentic</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
<style>
/* === Reset & Base (layout-rules + typography-rules) === */
* { margin: 0; padding: 0; box-sizing: border-box; }
html, body {
  width: 1920px;
  height: 1080px;
  overflow: hidden;
  background: #0D0D0D;
  color: #FFFFFF;
  font-family: 'Noto Sans JP', sans-serif;
  font-weight: 400;
  font-size: 16px;
  line-height: 1.6;
  letter-spacing: 0.04em;
}

/* === Slide Container (80px padding all sides) === */
.slide {
  width: 1920px;
  height: 1080px;
  padding: 80px;
  display: flex;
  flex-direction: column;
}

/* === Title (left-aligned, 36px) === */
.slide-title {
  font-size: 36px;
  font-weight: 700;
  color: #FFFFFF;
  line-height: 1.2;
  margin-bottom: 6px;
}
.slide-subtitle {
  font-size: 18px;
  color: #9CA3AF;
  margin-bottom: 40px;
}
.accent-red { color: #DC2626; font-weight: 700; }

/* === Diagram Wrapper (relative for SVG overlay) === */
.diagram-area {
  flex: 1;
  position: relative;
}

/* === SVG Connectors === */
.diagram-area svg {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  pointer-events: none;
}

/* === Node Base (diagram-rules: 角丸矩形, padding内余白, 左ボーダー4px) === */
.node {
  position: absolute;
  border-radius: 12px;
  padding: 16px 22px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  text-align: center;
  line-height: 1.4;
}
.node-name {
  font-size: 17px;
  font-weight: 700;
  color: #FFFFFF;
}
.node-desc {
  font-size: 13px;
  color: #E5E7EB;
  margin-top: 3px;
}
.node-tag {
  display: inline-block;
  font-size: 10px;
  font-weight: 700;
  padding: 2px 10px;
  border-radius: 9999px;
  margin-top: 8px;
  letter-spacing: 0.08em;
}

/* === Blue Node === */
.n-blue {
  background: rgba(66,133,244,0.10);
  border: 2px solid #4285F4;
  border-left: 4px solid #4285F4;
}
.n-blue .node-tag {
  background: rgba(66,133,244,0.20);
  color: #4285F4;
}

/* === Neutral Node (API hub) === */
.n-neutral {
  background: rgba(255,255,255,0.04);
  border: 2px solid rgba(255,255,255,0.35);
  border-left: 4px solid #FFFFFF;
}

/* === Red Node (Gemini Pro - most prominent) === */
.n-red {
  background: rgba(220,38,38,0.12);
  border: 2px solid #DC2626;
  border-left: 4px solid #DC2626;
  box-shadow: 0 0 32px rgba(220,38,38,0.20), 0 0 8px rgba(220,38,38,0.10);
}
.n-red .node-name { font-size: 19px; }
.n-red .node-tag {
  background: #DC2626;
  color: #FFFFFF;
}

/* === Amber Node (Vertex AI Search) === */
.n-amber {
  background: rgba(217,119,6,0.10);
  border: 2px solid #D97706;
  border-left: 4px solid #D97706;
}
.n-amber .node-tag {
  background: rgba(217,119,6,0.20);
  color: #D97706;
}

/* === Legend === */
.legend {
  position: absolute;
  bottom: 0;
  right: 0;
  display: flex;
  gap: 28px;
  align-items: center;
}
.legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 11px;
}
.legend-dot {
  width: 12px; height: 12px;
  border-radius: 3px;
}
.legend-line {
  width: 28px; height: 0;
}
</style>
</head>
<body>
<div class="slide">
  <div class="slide-title">System Architecture</div>
  <div class="slide-subtitle"><span class="accent-red">Stop-first</span> Agentic AI &mdash; Cloud Run + Gemini</div>

  <div class="diagram-area">
    <!-- ===== SVG Connectors ===== -->
    <svg viewBox="0 0 1760 790" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <marker id="ah-gray" markerWidth="10" markerHeight="8" refX="9" refY="4" orient="auto">
          <polygon points="0,0 10,4 0,8" fill="#6B7280"/>
        </marker>
        <marker id="ah-blue" markerWidth="10" markerHeight="8" refX="9" refY="4" orient="auto">
          <polygon points="0,0 10,4 0,8" fill="#4285F4"/>
        </marker>
        <marker id="ah-red" markerWidth="10" markerHeight="8" refX="9" refY="4" orient="auto">
          <polygon points="0,0 10,4 0,8" fill="#DC2626"/>
        </marker>
        <marker id="ah-amber" markerWidth="10" markerHeight="8" refX="9" refY="4" orient="auto">
          <polygon points="0,0 10,4 0,8" fill="#D97706"/>
        </marker>
        <marker id="ah-amber-rev" markerWidth="10" markerHeight="8" refX="1" refY="4" orient="auto">
          <polygon points="10,0 0,4 10,8" fill="#D97706"/>
        </marker>
      </defs>

      <!-- User → UI: 見積書PDF -->
      <line x1="190" y1="160" x2="320" y2="160" stroke="#6B7280" stroke-width="2" marker-end="url(#ah-gray)"/>
      <text x="255" y="148" fill="#9CA3AF" font-size="11" text-anchor="middle" font-family="Noto Sans JP,sans-serif">見積書PDF</text>

      <!-- UI → API: POST /classify_pdf -->
      <line x1="560" y1="200" x2="680" y2="360" stroke="#6B7280" stroke-width="2" marker-end="url(#ah-gray)"/>
      <text x="600" y="270" fill="#9CA3AF" font-size="11" text-anchor="middle" font-family="Noto Sans JP,sans-serif" transform="rotate(12,600,270)">POST /classify_pdf</text>

      <!-- API → Flash: PDF解析 -->
      <line x1="930" y1="355" x2="1080" y2="155" stroke="#4285F4" stroke-width="2" marker-end="url(#ah-blue)"/>
      <text x="1020" y="235" fill="#4285F4" font-size="11" text-anchor="middle" font-family="Noto Sans JP,sans-serif" font-weight="700">PDF解析</text>

      <!-- Flash → API: 抽出結果 (dashed return) -->
      <line x1="1080" y1="175" x2="930" y2="370" stroke="#4285F4" stroke-width="1.5" stroke-dasharray="6,4" marker-end="url(#ah-blue)"/>
      <text x="985" y="295" fill="#4285F4" font-size="10" text-anchor="middle" font-family="Noto Sans JP,sans-serif" opacity="0.8">抽出結果</text>

      <!-- API → Pro: 全明細一括 (thick, prominent) -->
      <line x1="930" y1="390" x2="1080" y2="390" stroke="#DC2626" stroke-width="3" marker-end="url(#ah-red)"/>
      <text x="1005" y="378" fill="#DC2626" font-size="12" text-anchor="middle" font-family="Noto Sans JP,sans-serif" font-weight="700">全明細一括</text>

      <!-- Pro → API: 3値判定 (dashed return) -->
      <line x1="1080" y1="420" x2="930" y2="405" stroke="#DC2626" stroke-width="1.5" stroke-dasharray="6,4" marker-end="url(#ah-red)"/>
      <text x="1005" y="425" fill="#DC2626" font-size="10" text-anchor="middle" font-family="Noto Sans JP,sans-serif" opacity="0.8">3値判定</text>

      <!-- API → VS: GUIDANCE時 -->
      <line x1="930" y1="410" x2="1080" y2="590" stroke="#D97706" stroke-width="2" marker-end="url(#ah-amber)"/>
      <text x="988" y="510" fill="#D97706" font-size="11" text-anchor="middle" font-family="Noto Sans JP,sans-serif">GUIDANCE時</text>

      <!-- VS → API: 法令エビデンス (dashed return) -->
      <line x1="1080" y1="615" x2="930" y2="425" stroke="#D97706" stroke-width="1.5" stroke-dasharray="6,4" marker-end="url(#ah-amber)"/>
      <text x="1020" y="540" fill="#D97706" font-size="10" text-anchor="middle" font-family="Noto Sans JP,sans-serif" opacity="0.8">法令エビデンス</text>

      <!-- GUIDANCE Loop: dashed path API→UI→User (amber) -->
      <path d="M 770,440 C 770,680 400,680 220,680 C 120,680 120,580 120,440 L 120,310"
            stroke="#D97706" stroke-width="2" stroke-dasharray="8,5" fill="none" marker-end="url(#ah-amber)"/>

      <!-- Loop label -->
      <rect x="360" y="660" rx="14" ry="14" width="250" height="28" fill="rgba(217,119,6,0.08)" stroke="#D97706" stroke-width="1"/>
      <text x="485" y="679" fill="#D97706" font-size="12" text-anchor="middle" font-family="Noto Sans JP,sans-serif" font-weight="700">GUIDANCE 対話ループ</text>

      <!-- User answer path: User→(via API)→Pro -->
      <path d="M 120,240 C 120,480 500,500 770,460"
            stroke="#D97706" stroke-width="2" stroke-dasharray="8,5" fill="none" marker-end="url(#ah-amber)"/>
      <text x="400" y="480" fill="#D97706" font-size="11" text-anchor="middle" font-family="Noto Sans JP,sans-serif">ユーザー回答</text>

      <!-- API → UI: diff表示 (return) -->
      <line x1="680" y1="395" x2="560" y2="240" stroke="#6B7280" stroke-width="1.5" stroke-dasharray="6,4" marker-end="url(#ah-gray)"/>
      <text x="600" y="330" fill="#9CA3AF" font-size="10" text-anchor="middle" font-family="Noto Sans JP,sans-serif">diff表示</text>
    </svg>

    <!-- ===== Nodes ===== -->

    <!-- User -->
    <div class="node n-blue" style="left:0; top:120px; width:185px;">
      <div class="node-name">User</div>
      <div class="node-desc">ユーザー</div>
    </div>

    <!-- UI: Streamlit on Cloud Run -->
    <div class="node n-blue" style="left:325px; top:110px; width:230px;">
      <div class="node-name">UI</div>
      <div class="node-desc">Streamlit on Cloud Run</div>
    </div>

    <!-- API: FastAPI on Cloud Run -->
    <div class="node n-neutral" style="left:685px; top:330px; width:240px; min-height:100px;">
      <div class="node-name">API</div>
      <div class="node-desc">FastAPI on Cloud Run</div>
      <div class="node-tag" style="background:rgba(255,255,255,0.08); color:#9CA3AF;">Hub</div>
    </div>

    <!-- Gemini 2.0 Flash -->
    <div class="node n-blue" style="left:1090px; top:100px; width:290px;">
      <div class="node-name">Gemini 2.0 Flash</div>
      <div class="node-desc">Vision &mdash; PDF読取・構造化</div>
      <div class="node-tag">EXTRACT</div>
    </div>

    <!-- Gemini 3 Pro (MOST PROMINENT) -->
    <div class="node n-red" style="left:1090px; top:320px; width:290px; min-height:120px;">
      <div class="node-name">Gemini 3 Pro</div>
      <div class="node-desc">thinking = HIGH</div>
      <div class="node-tag">CAPEX / OPEX / GUIDANCE</div>
    </div>

    <!-- Vertex AI Search -->
    <div class="node n-amber" style="left:1090px; top:545px; width:290px;">
      <div class="node-name">Vertex AI Search</div>
      <div class="node-desc">法令・通達検索</div>
      <div class="node-tag">EVIDENCE</div>
    </div>

    <!-- ===== Legend ===== -->
    <div class="legend">
      <div class="legend-item">
        <div class="legend-line" style="border-top:2px solid #6B7280;"></div>
        <span style="color:#6B7280;">データフロー</span>
      </div>
      <div class="legend-item">
        <div class="legend-line" style="border-top:2px dashed #D97706;"></div>
        <span style="color:#D97706;">対話ループ</span>
      </div>
      <div class="legend-item">
        <div class="legend-dot" style="background:rgba(66,133,244,0.12); border:2px solid #4285F4;"></div>
        <span style="color:#4285F4;">Cloud Infra</span>
      </div>
      <div class="legend-item">
        <div class="legend-dot" style="background:rgba(220,38,38,0.12); border:2px solid #DC2626;"></div>
        <span style="color:#DC2626;">AI Judge</span>
      </div>
      <div class="legend-item">
        <div class="legend-dot" style="background:rgba(217,119,6,0.12); border:2px solid #D97706;"></div>
        <span style="color:#D97706;">Legal Search</span>
      </div>
    </div>
  </div>
</div>
</body>
</html>
